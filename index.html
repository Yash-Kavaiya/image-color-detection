<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Palette Detector</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 h-screen flex justify-center items-center">

<div class="max-w-3xl bg-white shadow-md rounded-md p-8 flex space-x-8">
    <div class="flex flex-col justify-center items-center space-y-4">
        <h2 class="text-lg font-semibold mb-4">Upload Image</h2>
        <input type="file" id="imageInput" accept="image/*" class="py-2 px-4 border border-gray-300 rounded-md">
        <div id="uploadedImageContainer" class="mt-4">
            <img id="uploadedImage" class="max-w-xs max-h-xs" alt="Uploaded Image">
        </div>
    </div>
    <div class="flex flex-col justify-center items-center space-y-4">
        <h2 class="text-lg font-semibold mb-4">Color Palette</h2>
        <div id="colorPalette" class="flex flex-wrap"></div>
    </div>
</div>

<!-- <script>
    function processImage() {
        const imageInput = document.getElementById('imageInput');
        const uploadedImage = document.getElementById('uploadedImage');
        const colorPalette = document.getElementById('colorPalette');

        const file = imageInput.files[0];
        if (!file) return;

        const img = new Image();
        img.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, img.width, img.height);
            const imageData = ctx.getImageData(0, 0, img.width, img.height).data;

            const palette = new Set();
            for (let i = 0; i < imageData.length; i += 4) {
                const color = [imageData[i], imageData[i + 1], imageData[i + 2]];
                palette.add(JSON.stringify(color));
            }

            colorPalette.innerHTML = '';
            palette.forEach(color => {
                const rgb = JSON.parse(color);
                const div = document.createElement('div');
                div.style.backgroundColor = `rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]})`;
                div.style.width = '20px';
                div.style.height = '20px';
                div.style.margin = '5px';
                colorPalette.appendChild(div);
            });
        };

        const reader = new FileReader();
        reader.onload = function (e) {
            uploadedImage.src = e.target.result;
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }

    document.getElementById('imageInput').addEventListener('change', processImage);
</script> -->
<script>
    function processImage() {
        const imageInput = document.getElementById('imageInput');
        const uploadedImage = document.getElementById('uploadedImage');
        const colorPalette = document.getElementById('colorPalette');
        const copyButton = document.getElementById('copyButton');

        const file = imageInput.files[0];
        if (!file) return;

        const img = new Image();
        img.onload = function () {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, img.width, img.height);
            const imageData = ctx.getImageData(0, 0, img.width, img.height).data;

            const colorCount = {};
            for (let i = 0; i < imageData.length; i += 4) {
                const color = [imageData[i], imageData[i + 1], imageData[i + 2]];
                const hexColor = rgbToHex(color[0], color[1], color[2]);
                colorCount[hexColor] = (colorCount[hexColor] || 0) + 1;
            }

            const sortedColors = Object.keys(colorCount).sort((a, b) => colorCount[b] - colorCount[a]);
            colorPalette.innerHTML = '';
            for (let i = 0; i < Math.min(sortedColors.length, 5); i++) {
                const hexColor = sortedColors[i];
                const rgbColor = hexToRgb(hexColor);
                const div = document.createElement('div');
                div.style.backgroundColor = hexColor;
                div.style.width = '20px';
                div.style.height = '20px';
                div.style.margin = '5px';
                colorPalette.appendChild(div);

                const colorCode = document.createElement('span');
                colorCode.innerText = `HEX: ${hexColor}, RGB: ${rgbColor}`;
                colorPalette.appendChild(colorCode);
                colorPalette.appendChild(document.createElement('br'));
            }

            copyButton.addEventListener('click', () => {
                const paletteCode = sortedColors.slice(0, 5).join(', ');
                navigator.clipboard.writeText(paletteCode);
                alert('Color palette copied to clipboard!');
            });
        };

        const reader = new FileReader();
        reader.onload = function (e) {
            uploadedImage.src = e.target.result;
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }

    function rgbToHex(r, g, b) {
        return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    }

    function hexToRgb(hex) {
        const bigint = parseInt(hex.substring(1), 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return `${r}, ${g}, ${b}`;
    }

    document.getElementById('imageInput').addEventListener('change', processImage);
</script>

</body>
</html>
